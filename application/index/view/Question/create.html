<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>{block name="title"}调查问卷{/block}</title>
    <link rel="stylesheet" href="/static/admin/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="/static/index/css/animate.css"/>
    <link rel="stylesheet" href="/static/index/css/index.css"/>
    <link rel="stylesheet" href="/static/layui/css/layui.css">
    <link href="/static/lib/Hui-iconfont_v1.0.9/1.0.9/iconfont.css" rel="stylesheet" type="text/css"/>
    <script src="/static/index/js/jquery-3.3.1.min.js"></script>
    <script src="/static/index/js/bootstrap.min.js"></script>
    <script src="/static/layui/layui.js"></script>
</head>
<body style="overflow-x: hidden;background-color: #fafafa" onload="">
<form >
{include file="public/_firstTitle" /}
<div id="secondHeader">
    <nav class="navbar navbar-default navbar-static-top">
        <div class="container">
            <div class="navbar-menu collapse navbar-collapse" style="margin-left: -110px">
                <ul class="nav navbar-nav navbar-left">
                    <li style="margin-left: 25px;">
                        <a href="{:url('index/question/create')}" id="" class="navbar-link"
                           style="color: #2f8cdb;">编辑</a><span>|</span></li>
                    <li><a href="#" onclick="layer_show('投放问卷','{:url("index/index/share")}','379','401')" id="1"
                        class="navbar-link" >投放</a><span>|</span></li>
                    <li><a href="{:url('index/Statistics/dataView')}" id="2" class="navbar-link">统计</a><span>|</span>
                    </li>
                </ul>
                <ul class="nav navbar-nav navbar-right" style="margin-right: -110px">
                    <li>
                        <label for="edit" class="control-label no-padding-right" style="padding-top: 18px;"><i
                                class="Hui-iconfont" style="">&#xe616;</i></label>
                        <a href="{:url('index/question/textEdit')}" id="edit">文本编辑</a>
                    </li>
                    <li>
                        <label for="setting" class="control-label no-padding-right" style="padding-top: 18px;"><i
                                class="Hui-iconfont">&#xe61d;</i></label>
                        <a href="#" id="setting" onclick="layer_show('设置','{:url("index/surset/set",["surId"=>$sur.surId])}','640','520')">设置</a>
                    </li>
                    <li>
                        <label for="view" class="control-label no-padding-right" style="padding-top: 18px;"><i
                                class="Hui-iconfont" style="">&#xe725;</i></label>
                        <a href="{:url('index/preview/view_sur1',['surId'=>$sur.surId])}" id="view"
                           target="_blank">预览</a>
                    </li>
                    <li>
                        <button class="btn btn-primary"><i class="Hui-iconfont" style="">&#xe6e6;</i>开始回收</button>
                    </li>

                </ul>
            </div>
        </div>

    </nav>
</div>
<div id="editor">
    <div class="tab">
        <a href="" class="tab_item current" style="">题目控件</a>
        <a href="" class="tab_item">我的题库</a>
    </div>
    <div class="tab_content question_type" id="menu" style="display: block">
        <ul>
            <li class="type_item" onclick="addQues('添加单选题','{:url("index/question/single",["id"=>0,"surId"=>$sur.surId])}')"><a href="javascript:;"><span class="ico"><i
                    class="Hui-iconfont">&#xe601;</i></span><span>单选题</span></a></li>
            <li class="type_item" onclick="addQues('添加多选题','{:url("index/question/multiple",["id"=>0,"surId"=>$sur.surId])}')"><a href="javascript:;"><span class="ico"><i
                    class="Hui-iconfont">&#xe614;</i></span><span>多选题</span></a></li>
            <li class="type_item" onclick="addQues('添加下拉题','{:url("index/question/pull",["id"=>0,"surId"=>$sur.surId])}')"><a href="javascript:;"><span class="ico"><i
                    class="Hui-iconfont">&#xe698;</i></span><span>下拉题</span></a></li>
            <li class="type_item" onclick="addQues('添加矩形单选题','{:url("index/question/rectangleSig",["id"=>0,"surId"=>$sur.surId])}')"><a href="javascript:;"><span class="ico"><i
                    class="Hui-iconfont">&#xe64d;</i></span><span>矩形单选题</span></a></li>
            <li class="type_item" onclick="addQues('添加矩形多选题','{:url("index/question/rectangleMul",["id"=>0,"surId"=>$sur.surId])}')"><a href="javascript:;"><span class="ico"><i
                    class="Hui-iconfont">&#xe6ea;</i></span><span>矩形多选题</span></a></li>
            <li class="type_item" onclick="addQues('添加排序题','{:url("index/question/sort",["id"=>0,"surId"=>$sur.surId])}')"><a href="javascript:;"><span class="ico"><i
                    class="Hui-iconfont">&#xe675;</i></span><span>排序题</span></a></li>
            <li class="type_item" onclick="addQues('添加量表题','{:url("index/question/scale",["id"=>0,"surId"=>$sur.surId])}')"><a href="javascript:;"><span class="ico"><i
                    class="Hui-iconfont">&#xe701;</i></span><span>量表题</span></a></li>
        </ul>
    </div>
</div>
<div class="editor_main" style="margin-top: 144px;margin-left:300px;width:950px;background-color: white">
    <div class="survey_page"></div>
    <div class="survey_main">
        <input type="hidden" value="{$sur.surId}" id="surId">
        <form action="">
            <div class="survey_title" style="margin-right: 90px;margin-top:20px;padding: 9px 10px;width: 100%;">
                <a class="title_content" style="padding: 10px 0;margin: 0 145px;">
                    <input type="text" contenteditable="true" onblur="saveTitle('{:url('index/survey/saveTitle')}')" id="title"
                           style=" border:none;text-align: center;width: 710px;line-height: 25px;font-size: 24px;color: rgb(51, 51, 51)"
                           value="{$sur.surName}">
                </a>
            </div>
        </form>

        <div class="survey_desc" style="margin-left: -20px;margin-right: 90px;margin-top:20px;padding: 9px 10px">
            <form action="">
                <div class="layui-form-item layui-form-text">
                    <div class="layui-input-block">
                    <textarea placeholder="请输入内容" onblur="saveDesc('{:url("index/survey/saveDesc")}')" id="desc" contenteditable="true"
                              class="layui-textarea" id="length"
                              style="resize:none;overflow:hidden;font-size: 20px;border:1px"
                              oninput="checked(this.value)" onchange="borderSet(this.value)">{$sur.surDesc}</textarea>
                    </div>
                </div>
            </form>
        </div>
        <form class="layui-form" action="">
        <div style="margin-left: 115px;margin-right: 90px;">
            {volist name="quesInfo" id="vo"}
            <!--<?php $key = $key + 1 ?>-->
            <span style="float: left">{$key}.</span>
                {if $vo.quesType == "单选题"}
                <div id="ques{$vo.quesId}" onmouseover="quesOpOver('{$vo.quesId}',this)" onmouseout="quesOpOut('{$vo.quesId}',this)">
                    <div onmouseover=""  onclick="addQues('添加单选题','{:url("index/question/single",["id"=>$vo.quesId,"surId"=>$sur.surId])}')"
                    style="width:950px;margin-left:-100px;padding-left:100px;min-height:220px;">
                    <div style="width: 745px">
                        <input type="hidden" name="quesId" value="{$vo.quesId}">
                        <div style="padding-bottom: 10px">
                            <span style="margin-left: 5px">{$vo.quesTitle}</span>
                            {if $vo.quesReq == 1}<span style="color: red">*</span>{/if}
                        </div>
                        <div style="margin-left: 10px;margin-bottom: 5px">{$vo.quesDesc}</div>
                        <ul>
                            {volist name="vo.answer" id="vo2"}
                            <li><input type="radio" style="margin-left: 10px;margin-right: 10px;margin-top: 20px" title="{$vo2.answer}"></li>
                            {/volist}
                        </ul>
                    </div>
                </div>
                {include file="public/quesOp" /}
                </div>
                {/if}
                {if $vo.quesType == "多选题"}
                 <div id="ques{$vo.quesId}" onmouseover="quesOpOver('{$vo.quesId}')" onmouseout="quesOpOut('{$vo.quesId}')">
                    <div onclick="addQues('添加多选题','{:url("index/question/multiple",["id"=>$vo.quesId,"surId"=>$sur.surId])}')"
                     style="width:950px;margin-left:-100px;padding-left:100px;min-height:220px">
                        <div style="width: 745px">
                            <input type="hidden" name="quesId" value="{$vo.quesId}">
                            <div style="padding-bottom: 10px"><span style="margin-left: 5px">{$vo.quesTitle}</span>
                                {if $vo.quesReq == 0}<span style="color: red">*</span>{/if}
                            </div>
                            <div style="margin-left: 10px;margin-bottom: 10px">{$vo.quesDesc}</div>

                            <ul>
                                {volist name="vo.answer" id="vo2"}
                                <li  style="margin-top: 8px"><input type="checkbox" lay-skin="primary" title="{$vo2.answer}"></li>
                                {/volist}
                            </ul>
                        </div>
                    </div>
                {include file="public/quesOp" /}
                </div>
                {/if}
                {if $vo.quesType == "矩形单选题"}
                <div id="ques{$vo.quesId}" onmouseover="quesOpOver('{$vo.quesId}')" onmouseout="quesOpOut('{$vo.quesId}')">
                    <div onclick="addQues('添加矩形单选题','{:url("index/question/rectangleSig",["id"=>$vo.quesId,"surId"=>$sur.surId])}')"
                    style="width:950px;margin-left:-100px;padding-left:100px;min-height:220px">
                     <div style="width: 745px">
                        <input type="hidden" name="quesId" value="{$vo.quesId}">
                        <div style="padding-bottom: 10px"><span style="margin-left: 5px">{$vo.quesTitle}</span>
                            {if $vo.quesReq == 0}<span style="color: red">*</span>{/if}
                        </div>
                        <div style="margin-left: 10px">{$vo.quesDesc}</div>
                        <table class="layui-table" lay-skin="line" style="border: none">
                            <colgroup>
                                <col width="150">
                                {volist name="vo.inner" id="vo2"}
                                <col width="200">
                                {/volist}
                            </colgroup>
                            <thead>
                            <tr>
                                <th></th>
                                {volist name="vo.inner" id="vo2"}
                                    <th style="text-align: center">{$vo2.quesInner}</th>
                                {/volist}
                            </tr>
                            </thead>
                            <tbody>
                            {volist name="vo.answer" id="vo2"}
                            <tr>
                                <th style="text-align: center">{$vo2.answer}</th>
                                {volist name="vo.inner" id="vo2"}
                                <th style="text-align: center"><input type="radio"></th>
                                {/volist}
                            </tr>
                            {/volist}
                            </tbody>
                        </table>
                     </div>
                    </div>
                        {include file="public/quesOp" /}
                    </div>
                {/if}
                {if $vo.quesType == "矩形多选题"}
                <div id="ques{$vo.quesId}" onmouseover="quesOpOver('{$vo.quesId}')" onmouseout="quesOpOut('{$vo.quesId}')">
                    <div onclick="addQues('添加矩形多选题','{:url("index/question/rectangleMul",["id"=>$vo.quesId,"surId"=>$sur.surId])}')"
                    style="width:950px;margin-left:-100px;padding-left:100px;min-height:220px">
                        <div style="width: 745px">
                           <input type="hidden" name="quesId" value="{$vo.quesId}">
                           <div style="padding-bottom: 10px"><span style="margin-left: 5px">{$vo.quesTitle}</span>
                               {if $vo.quesReq == 0}<span style="color: red">*</span>{/if}
                           </div>
                           <div style="margin-left: 10px">{$vo.quesDesc}</div>
                           <table class="layui-table" lay-skin="line" style="border: none">
                               <colgroup>
                                   <col width="150">
                                   {volist name="vo.inner" id="vo2"}
                                   <col width="200">
                                   {/volist}
                               </colgroup>
                               <thead>
                               <tr>
                                   <th></th>
                                   {volist name="vo.inner" id="vo2"}
                                   <th style="text-align: center">{$vo2.quesInner}</th>
                                   {/volist}
                               </tr>
                               </thead>
                               <tbody>
                               {volist name="vo.answer" id="vo2"}
                               <tr>
                                   <th style="text-align: center">{$vo2.answer}</th>
                                   {volist name="vo.inner" id="vo2"}
                                   <th style="text-align: center"><input type="checkbox" lay-skin="primary"></th>
                                   {/volist}
                               </tr>
                               {/volist}
                               </tbody>
                           </table>
                         </div>
                    </div>
                    {include file="public/quesOp" /}
                    </div>
                {/if}
                {if $vo.quesType == "下拉题"}
            <div id="ques{$vo.quesId}" onmouseover="quesOpOver('{$vo.quesId}')" onmouseout="quesOpOut('{$vo.quesId}')">
                    <div onclick="addQues('添加下拉题','{:url("index/question/pull",["id"=>$vo.quesId,"surId"=>$sur.surId])}')"
        style="width:950px;margin-left:-100px;padding-left:100px;min-height:220px">
                    <div style="width: 745px">
                        <input type="hidden" name="quesId" value="{$vo.quesId}">
                        <div style="padding-bottom: 10px;"><span style="margin-left: 5px">{$vo.quesTitle}</span>
                            {if $vo.quesReq == 0}<span style="color: red">*</span>{/if}
                        </div>
                        <div style="margin-left: 10px;height: 25px;padding-bottom: 10px">{$vo.quesDesc}</div>
                        <select name="answer" id="answer" style="!important;width: 150px" class="layui-inline">
                            <option value="" >请选择</option>
                            {volist name="vo.answer" id="vo2"}
                                <option value="{$vo2.answer}" style="margin-right: 10px;">{$vo2.answer}</option>
                            {/volist}
                        </select>
                    </div>
                    </div>
                {include file="public/quesOp" /}
                </div>
                {/if}
                {if $vo.quesType == "排序题"}
    <div id="ques{$vo.quesId}" onmouseover="quesOpOver('{$vo.quesId}')" onmouseout="quesOpOut('{$vo.quesId}')">
                    <div onclick="addQues('添加排序题','{:url("index/question/sort",["id"=>$vo.quesId,"surId"=>$sur.surId])}')"
        style="width:950px;margin-left:-100px;padding-left:100px;min-height:220px">
                        <div style="width: 745px">
                            <input type="hidden" name="quesId" value="{$vo.quesId}">
                            <div style="padding-bottom: 10px"><span style="margin-left: 5px">{$vo.quesTitle}</span>
                                {if $vo.quesReq == 0}<span style="color: red">*</span>{/if}
                            </div>
                            <div style="margin-left: 10px;margin-bottom: 10px">{$vo.quesDesc}</div>
                            <ul>
                                {volist name="vo.answer" id="vo2"}
                                <li><input type="checkbox" lay-skin="primary">
                                    {$vo2.answer}</li>
                                {/volist}
                            </ul>
                        </div>
                    </div>
                {include file="public/quesOp" /}
                </div>
                {/if}
                {if $vo.quesType == "量标题"}
                <?php $vo2 = $vo['scale'] ?>
                <div id="ques{$vo.quesId}" onmouseover="quesOpOver('{$vo.quesId}')" onmouseout="quesOpOut('{$vo.quesId}')" >
                    <div onclick="addQues('添加量表题','{:url("index/question/scale",["id"=>$vo.quesId,"surId"=>$sur.surId])}')"
                    style="width:950px;margin-left:-100px;padding-left:100px;min-height:220px">
                        <div style="width: 745px">
                            <input type="hidden" id="scale{$vo2.scaleId}" value="{$vo2.scaleId}">
                            <input type="hidden" id="scale{$vo2.scaleRange}" value="{$vo2.scaleRange}">
                            <input type="hidden" name="quesId" value="{$vo.quesId}">
                            <div style="padding-bottom: 10px"><span style="margin-left: 5px">{$vo.quesTitle}</span>
                                {if $vo.quesReq == 0}<span style="color: red">*</span>{/if}
                            </div>
                            <div style="margin-left: 10px">{$vo.quesDesc}</div>

                            <input type="hidden" value="">
                            <div class="option">
                                <span>
                                <span style="color: gray;font-size: 14px;padding-right: 10px;padding-top: 25px">非常不满意</span>
                                <?php $scaleRange = $vo2['scaleRange'] + 1; ?>
                               {for start="1" end="$scaleRange"}
                                    <input type="radio" name="" title="{$i}">
                                {/for}
                                <span style="color: gray;font-size: 14px">非常满意</span>
                                </span></div>
                        </div>
                    </div>
                    {include file="public/quesOp" /}
                </div>
                {/if}
            {/volist}
        </div>
</form>

    </div>

<div id="question_subjects">
    <ul style="margin:10px;padding:0;">
    </ul>
</div>

</div>
</body>
{include file="public/_baseJs" /}
<script src="/static/lib/easyui/jquery.easyui.min.js"></script>
<style type="text/css">
    .drag-item {
        list-style-type: none;
        display: block;
        padding: 25px;
        border: 1px solid #ccc;
        margin: 2px;
        background: #fafafa;
        color: #444;
    }

    .indicator {
        position: absolute;
        font-size: 9px;
        width: 10px;
        height: 10px;
        display: none;
        color: red;
    }
</style>
<script src="/static/index/js/create_ques.js"></script>
<script>
    layui.use('form', function () {
        var form = layui.form;
    });
</script>
<script>

    // var currentKeyCode = -1,altkey=false ,rightKey= false,pageY=0,listernType= null;
    // $(window).keydown( function(){
    //     top.altkey = event.altKey;
    //     top.currentKeyCode = event.keyCode;
    // });
    // $(document).on("contextmenu" , function(e){
    //     rightKey = true ;
    //
    // });
    // function isReloadOrClose(event){
    //     var msg= null ;
    //     if (currentKeyCode == 116 || rightKey) {
    //         //116:F5
    //         if (currentKeyCode == 116){
    //             msg = "刷新窗口!(F5)" ;
    //         }
    //         if (rightKey){
    //             msg = "右键刷新窗口!" ;
    //         }
    //         top.listernType = "reload" ;
    //     } else{
    //         msg = "点击关闭窗口" ;
    //         top.listernType = "close" ;
    //         if ((altkey || currentKeyCode == 18) || (currentKeyCode == 115) ){
    //             msg = "关闭窗口!(alt+F4)" ;
    //         }
    //         if (currentKeyCode == 91){
    //             msg = "Mac关闭窗口!(commad)" ;
    //         }
    //     }
    //     currentKeyCode = -1,altkey=false ,rightKey= false,pageY=0,listernType= null;
    //     return msg;
    // }
    // window.onbeforeunload = function (event) {
    //     return isReloadOrClose(event)
    // }


    // $(document).ready(function (e) {
    //     var surId = document.getElementById('surId').value;
    //     if (window.history && window.history.pushState) {
    //         $(window).on('popstate', function () {
    //             layer.confirm("离开此页面？不会保存你的更改", function () {
    //                 $.ajax({
    //                     url: "{:url('index/survey/delSur')}",
    //                     data: {surId: surId},
    //                     dataType: 'json',
    //                     type: 'post',
    //                     success: function (data) {
    //                         if (data.code == 1) {
    //                             window.history.back();
    //                         }
    //                     }
    //                 })
    //             })
    //
    //         });
    //     }
    //
    //     window.history.pushState('forward', null, '#'); //在IE中必须得有这两行
    //     window.history.forward(1);
    // })
    // document.body.onbeforeunload = function (event) {
    //     var c = event || window.event;
    //     if (/webkit/.test(navigator.userAgent.toLowerCase())) {
    //         return "asda";
    //         // return "离开页面将导致数据丢失！";
    //     }else {
    //         c.returnValue = "12`1123";
    //     }
    // }
</script>
</html>
